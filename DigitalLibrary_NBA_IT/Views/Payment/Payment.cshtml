<form method="post" action="@Url.Action("ProcessPayment", "Payment")">
    @Html.AntiForgeryToken()

    <h5 class="mt-4">Payment Details</h5>

    <div class="mb-3">
        <label for="creditCard" class="form-label">Credit Card Number</label>
        <input type="text" name="CreditCardNumber" id="creditCard" class="form-control" placeholder="XXXX-XXXX-XXXX-XXXX" maxlength="16" value="@TempData["CreditCardNumber"]" required />
        @if (TempData["CreditCardError"] != null)
        {
            <small class="text-danger">@TempData["CreditCardError"]</small>
        }
    </div>

    <div class="mb-3">
        <label for="expiryDate" class="form-label">Expiry Date</label>
        <input type="month" name="ExpiryDate" id="expiryDate" class="form-control" required />
        @if (TempData["ExpiryDateError"] != null)
        {
            <small class="text-danger">@TempData["ExpiryDateError"]</small>
        }
    </div>

    <div class="mb-3">
        <label for="cvv" class="form-label">CVV</label>
        <input type="password" name="CVV" id="cvv" class="form-control" placeholder="XXX" maxlength="3" required />
        @if (TempData["CVVError"] != null)
        {
            <small class="text-danger">@TempData["CVVError"]</small>
        }
    </div>

    <div class="mb-3">
        <label for="idNumber" class="form-label">ID Number</label>
        <input type="text" name="IDNumber" id="idNumber" class="form-control" maxlength="9" required />
        @if (TempData["IDNumberError"] != null)
        {
            <small class="text-danger">@TempData["IDNumberError"]</small>
        }
    </div>

    <button type="submit" class="btn btn-primary w-100 mt-4">Pay $@TempData["TotalAmount"]</button>

    @if (TempData["Message"] != null)
    {
        <div class="alert alert-info mt-3">@TempData["Message"]</div>
    }
</form>




<script>
    function validatePaymentForm() {
        const creditCardInput = document.getElementById("creditCard");
        const cvvInput = document.getElementById("cvv");
        const creditCardError = document.getElementById("creditCardError");
        const cvvError = document.getElementById("cvvError");

        let isValid = true;

        // Validate Credit Card Number
        if (creditCardInput.value.length !== 16 || isNaN(creditCardInput.value)) {
            creditCardError.style.display = "block";
            isValid = false;
        } else {
            creditCardError.style.display = "none";
        }

        // Validate CVV
        if (cvvInput.value.length !== 3 || isNaN(cvvInput.value)) {
            cvvError.style.display = "block";
            isValid = false;
        } else {
            cvvError.style.display = "none";
        }

        if (idNumberInput.value.length !== 9 || isNaN(idNumberInput.value)) {
            idNumberError.style.display = "block";
            isValid = false;
        } else {
            idNumberError.style.display = "none";
        }


        return isValid;
    }
</script>
